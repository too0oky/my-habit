<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Habitify</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <style>
        :root {
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --primary: #007AFF;
            --success: #34C759;
            --text: #1C1C1E;
            --text-sub: #8E8E93;
        }

        body {
            font-family: -apple-system, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            width: 100%;
            max-width: 400px;
            margin: 20px 0;
        }

        h1 { font-size: 28px; margin: 0; }
        .date { color: var(--text-sub); font-size: 16px; }

        .progress-container {
            width: 100%;
            max-width: 400px;
            background: #E5E5EA;
            height: 8px;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }

        #progress-bar {
            background: var(--success);
            width: 0%;
            height: 100%;
            transition: width 0.3s ease;
        }

        .habit-list {
            width: 100%;
            max-width: 400px;
        }

        .habit-item {
            background: var(--card);
            margin-bottom: 12px;
            padding: 20px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: transform 0.1s;
        }

        .habit-item:active { transform: scale(0.98); }

        .habit-info { display: flex; flex-direction: column; }
        .habit-title { font-size: 18px; font-weight: 600; }
        .habit-time { font-size: 13px; color: var(--text-sub); }

        .checkbox {
            width: 30px;
            height: 30px;
            border: 2px solid #C7C7CC;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .habit-item.done .checkbox {
            background: var(--success);
            border-color: var(--success);
        }

        .habit-item.done .checkbox::after {
            content: "‚úì";
            color: white;
            font-weight: bold;
        }

        .habit-item.done .habit-title {
            text-decoration: line-through;
            color: var(--text-sub);
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="date" id="today-date">202X/XX/XX</div>
        <h1>‰ªäÊó•„ÅÆÁøíÊÖ£</h1>
    </div>

    <div class="progress-container">
        <div id="progress-bar"></div>
    </div>

    <div class="habit-list" id="habit-list">
        <div class="habit-item" onclick="toggleHabit(0)">
            <div class="habit-info">
                <span class="habit-title">6:00„Å´Ëµ∑Â∫ä</span>
                <span class="habit-time">Morning Routine</span>
            </div>
            <div class="checkbox"></div>
        </div>
        <div class="habit-item" onclick="toggleHabit(1)">
            <div class="habit-info">
                <span class="habit-title">„Çπ„ÇØ„ÉØ„ÉÉ„Éà20Âõû</span>
                <span class="habit-time">Health</span>
            </div>
            <div class="checkbox"></div>
        </div>
        <div class="habit-item" onclick="toggleHabit(2)">
            <div class="habit-info">
                <span class="habit-title">‰ΩúÊ•≠/ÂãâÂº∑30ÂàÜ</span>
                <span class="habit-time">Self Improvement</span>
            </div>
            <div class="checkbox"></div>
        </div>
    </div>

    <script>
    const today = new Date().toLocaleDateString();
    let habitStates = [false, false, false];
    let streak = parseInt(localStorage.getItem('streakCount') || 0);

    window.onload = function() {
        document.getElementById('today-date').innerText = today;
        
        const savedDate = localStorage.getItem('lastSavedDate');
        
        // 1. Êó•‰ªò„ÅåÂ§â„Çè„Å£„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
        if (savedDate !== today) {
            // „ÇÇ„ÅóÊò®Êó•ÈÅîÊàê„Åó„Å¶„ÅÑ„Å™„Åã„Å£„Åü„Çâ„Çπ„Éà„É™„Éº„ÇØ„Çí„É™„Çª„ÉÉ„Éà
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            if (savedDate !== yesterday.toLocaleDateString() && savedDate !== null) {
                // ÂâçÊó•„ÅåÂÆå‰∫ÜÊó•„Åß„Å™„ÅÑ Ôºù ÈÄîÂàá„Çå„Åü
                streak = 0;
                localStorage.setItem('streakCount', 0);
            }
            
            // Êñ∞„Åó„ÅÑÊó•„ÅÆ„Åü„ÇÅ„Å´Áä∂ÊÖã„É™„Çª„ÉÉ„Éà
            habitStates = [false, false, false];
            localStorage.setItem('lastSavedDate', today);
            save();
        } else {
            // Âêå„ÅòÊó•„Å™„Çâ‰øùÂ≠ò„Åï„Çå„ÅüÁä∂ÊÖã„ÇíË™≠„ÅøËæº„ÇÄ
            const savedStates = JSON.parse(localStorage.getItem('habitStates'));
            if (savedStates) habitStates = savedStates;
        }
        render();
    }

    function toggleHabit(index) {
        habitStates[index] = !habitStates[index];
        
        // ÂÖ®È†ÖÁõÆ„ÉÅ„Çß„ÉÉ„ÇØ„Åï„Çå„Åü„ÅãÁ¢∫Ë™ç
        const allDoneBefore = habitStates.every(s => s === true);
        
        save();
        render();

        // „Åô„Åπ„Å¶ÂÆå‰∫Ü„Åó„ÅüÁû¨Èñì„Å´„Çπ„Éà„É™„Éº„ÇØ„ÇíÂ¢ó„ÇÑ„Åô
        const isAllDoneNow = habitStates.every(s => s === true);
        const lastStreakDate = localStorage.getItem('lastStreakDate');

        if (isAllDoneNow && lastStreakDate !== today) {
            streak++;
            localStorage.setItem('streakCount', streak);
            localStorage.setItem('lastStreakDate', today);
            alert(`üî• ${streak}Êó•ÈÄ£Á∂öÈÅîÊàêÔºÅ„Åì„ÅÆË™øÂ≠êÔºÅ`);
            render();
        }
    }

    function save() {
        localStorage.setItem('habitStates', JSON.stringify(habitStates));
    }

    function render() {
        const items = document.querySelectorAll('.habit-item');
        let doneCount = 0;

        habitStates.forEach((isDone, i) => {
            if (isDone) {
                items[i].classList.add('done');
                doneCount++;
            } else {
                items[i].classList.remove('done');
            }
        });

        // ÈÄ≤Êçó„Éê„ÉºÊõ¥Êñ∞
        const progress = (doneCount / habitStates.length) * 100;
        document.getElementById('progress-bar').style.width = progress + "%";
        
        // „Çπ„Éà„É™„Éº„ÇØË°®Á§∫ÔºàHTMLÂÅ¥„Å´Ë°®Á§∫Â†¥ÊâÄ„Çí‰Ωú„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„ÅôÔºâ
        document.getElementById('streak-display').innerText = `üî• ${streak}Êó•ÈÄ£Á∂ö`;
    }
    </script>
</body>
</html>

